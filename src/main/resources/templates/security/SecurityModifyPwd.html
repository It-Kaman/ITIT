<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"  lang="en" >
<head>
    <meta charset="UTF-8">
    <title>修改密码</title>
    <link rel="stylesheet" type="text/css" href="../../static/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../static/icon/ali-icon/iconfont.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/Page/font.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/Page/common.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/Page/header.css">
    <script type="application/javascript" src="../../static/js/jquery-3.4.1.js"></script>
    <script type="application/javascript" src="../../static/js/bootstrap.js"></script>
</head>
<style>
    /*版心部分 与注册指引一致*/
    section{
        /*height: 500px;*/
        /*background: black;*/
    }
    section>.title-show{
        width: 100%;
        padding-left: 5%;
        padding-right: 5%;
        /*height: 90px;*/
        margin-top: 50px;
        /*background: black;*/
        /*text-align: center;*/
        overflow: hidden;
    }
    section>.title-show>.title-container{
        width: 100%;
        overflow: hidden;
    }
    section>.title-show>.title-container>.title-line{
        width: 40%;
        margin-top: 44px;
        float: left;
    }
    section>.title-show>.title-container>span{
        width: 20%;
        display: inline-block;
        float: left;
        line-height: 90px;
        font-size: 35px;
        text-align: center;
    }
    section>.title-show>.content-label>label{
        font-size: 20px;
        display: block;
    }

    section>.register-content{
        width: 100%;
        padding: 0 25%;
        /*background: red;*/
        overflow: hidden;
        height: auto;
    }
    section>.register-content>span.msg{
        text-align: center;
        display: block;
        font-size: 20px;
        color: red;
    }
    section>.register-content>.form-group{
        margin-bottom: 30px;
    }
    section>.register-content>.form-group>label{
        font-size: 20px;
    }
    section>.register-content>.form-group>input{
        width: 100%;
    }
    section>.register-content>.form-group>div.alert{
        display: none;
    }
    /*checkbox*/
    section>.register-content>.btns{
        margin-top: 10px;
    }
    section>.register-content>.btns>.btn{
        width: 40%;
        height: 35px;
    }
    section>.register-content>.btns>.btn:nth-of-type(1){
        background: #07c160;
        color: white;
    }

    footer{
        margin-top: 100px;
        height: 40px;
        background: black;
        width: 100%;
        color: white;
        position: absolute;
        bottom: 0%;
    }
    footer>label{
        line-height: 40px;
        font-size: 15px;
    }

</style>
<body>
    <!--头部-->
    <header class="container-fluid">
        <!--左边部分-->
        <div class="icon-left">
            <a href="/index"><i class="zhanku">IT学习网站</i></a>
            <!--<a class="" href="#">首页</a>-->
        </div>
        <div class="air"></div>
        <!--查询-->
        <div class="Search-Modular">
            <input type="text" data-ope="normal" class="search-content" name="search-content" list="search-list" placeholder="请输入搜索关键词">
            <button class="iconfont icon-sousuo"></button>
            <datalist id="search-list"></datalist>
        </div>
        <!--右边部分-->
        <div class="header-right-list">
            <!--未登录-->
            <!--/*@thymesVar id="user" type="com.itit.entry.User"*/-->
            <ul th:if="${session.user == null}" class="unlogin">
                <li>
                    <a href="#">
                        <button class="contribute-btn">投稿</button>
                    </a>
                    <div class="Contribute-list">
                        <ul>
                            <li>
                                <a th:href="${#request.getServletContext().getContextPath()}+'/upload/article/record'" href="/upload/article/record">
                                    <i class="iconfont icon-nav"></i>
                                    <span>专栏投稿</span>
                                </a>
                            <li>
                                <a th:href="${#request.getServletContext().getContextPath()}+'/upload/video/record'" href="/upload/video/record">
                                    <i class="iconfont icon-shipin"></i>视频投稿
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="iconfont icon-yinpin"></i>音频管理
                                </a>
                            <li>
                                <a href="#">
                                    <i class="iconfont icon-guanli"></i>投稿管理
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="/register">注册</a>
                </li>
                <li>
                    <a href="/login">登录</a>
                </li>
                <li>
                    <div class="header-img">
                        <img th:src="${#request.getServletContext().getContextPath()}+'/static/img/header/default/akari.jpg'" class="img-circle" width="34px" height="34px"/>
                        <div class="header-img-list">
                            <ul>
                                <li class="btn-group">
                                    <a th:href="${#request.getServletContext().getContextPath()}+'/login'" href="/login"><div class="btn"><span>登录</span></div></a>
                                    <a th:href="${#request.getServletContext().getContextPath()}+'/register'" href="/register"><div class="btn"><span>注册</span></div></a>
                                </li>
                                <li>选择语言</li>
                            </ul>
                        </div>
                    </div>
                </li>
            </ul>
            <!--已登录-->
            <ul th:if="${session.user != null}" class="has-login" th:data-id="${session.user.getId()}">
                <li>
                    <a href="#">
                        <button class="contribute-btn">投稿</button>
                    </a>
                    <div class="Contribute-list">
                        <ul>
                            <li>
                                <a th:href="${#request.getServletContext().getContextPath()}+'/upload/article/record'"  href="/upload/article/record">
                                    <i class="iconfont icon-nav"></i>
                                    <span>专栏投稿</span>
                                </a>
                            <li>
                                <a  th:href="${#request.getServletContext().getContextPath()}+'/upload/video/record'" href="/upload/video/record">
                                    <i class="iconfont icon-shipin"></i>视频投稿
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <i class="iconfont icon-yinpin"></i>音频管理
                                </a>
                            <li>
                                <a href="#">
                                    <i class="iconfont icon-guanli"></i>投稿管理
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="#">历史</a></li>
                <li th:text="${session.user.anothername}"></li>
                <li><div class="header-img">
                    <img th:src="${session.user.header}" class="img-circle" width="34px" height="34px"/>
                    <div class="header-img-list">
                        <ul>
                            <li>
                                <ul>
                                    <li><a th:href="'/UserCenter?id='+${session.user.getId()}">个人中心</a></li>
                                    <li>投稿管理</li>
                                    <li>订单中心</li>
                                    <li>我的课程</li>
                                </ul>
                            </li>
                            <li>选择语言</li>
                            <li><a style="display: block" th:href="${#request.getServletContext().getContextPath()}+'/logout'">退出</a></li>
                        </ul>
                    </div>
                </div></li>
            </ul>
        </div>
    </header>
    <!--版心-->
    <section class="container">
        <div class="title-show">
            <div class="title-container">
                <div class="line title-line"></div>
                <span style="display: inline-block;font-size: 25px">修改用户密码</span>
                <div class="line title-line"></div>
            </div>
            <div class="clearfix"></div>
        </div>
        <form action="/passwordUpdate" method="post" id="register"></form>
        <div class="register-content">
            <span class="Msg" th:if="${#request.getAttribute('msg') != null}" th:text="${#request.getAttribute('msg')}"></span>
            <div class="form-group">
                <label class="control-label" for="oldPassword">当前密码:</label>
                <input type="password" class="form-control" id="oldPassword" name="oldPassword"  form="register">
                <br>
                <div class="alert alert-danger" role="alert">请输入当前密码！</div>
                <div class="alert alert-danger" role="alert" style="display: block" th:if="${#request.getAttribute('passwordError') != null}">密码不正确！</div>
            </div>
            <div class="form-group">
                <label class="control-label" for="newPassword">新密码:(长度为8-16位数字字母)</label>
                <input type="password" class="form-control" id="newPassword" form="register" name="newPassword">
                <br>
                <div class="alert alert-danger" role="alert">请填写长度为8-16位的密码</div>
                <div class="alert alert-danger" role="alert">请不要输入与当前密码相同的密码</div>
            </div>
            <div class="form-group">
                <label class="control-label" for="check-password">确认新密码:(长度为8-16位数字字母)</label>
                <input type="password" class="form-control" id="check-password" form="register" name="check-password">
                <br>
                <div class="alert alert-danger" role="alert">请输入正确密码</div>
            </div>
            <!--验证码-->
            <div class="yanzhenma"></div>
            <div class="btns">
                <input type="submit" class="btn commit" disabled form="register" value="修改"></input>
                <input type="reset" class="btn reset" form="register"></input>
            </div>
        </div>

    </section>
    <!--底部-->
    <footer>
        <label>&COPY;CopyRight From It-Kaman.All Rights Reserved.</label>
    </footer>
</body>
<script type="application/javascript" src="../../static/js/Page/header.js"></script>
<script>
    /*验证注册表单*/
    $(".form-group>input").on("change",function () {
        var flag =false;
        if ($(this).val() == "" || $(this).val().trim() == ""){
            $(this).parent().children("div.alert").eq(0).css({"display":"block"});
            flag = false;
        }else {
            $(this).parent().children("div.alert").eq(0).css({"display":"none"});
            flag = true;

            /*原始密码*/
            var oldPassword = $(".form-group>input").eq(0).val();
            if(oldPassword == null || oldPassword == ""){
                $(".form-group>input").eq(0).parent().children("div.alert").eq(0).css({"display":"block"});
                flag = false;
            }else {
                $(".form-group>input").eq(0).parent().children("div.alert").css({"display":"none"});
                flag = true;
            }


            /*新密码*/
            var Reg2 = /[0-9a-z]{8,16}/ig;
            var newPassword = $(".form-group>input").eq(1).val();
            if(newPassword.trim().match(Reg2) == null || newPassword.trim().match(/[ ]+/) != null){
                $(".form-group>input").eq(1).parent().children("div.alert").eq(0).css({"display":"block"});
                flag = false;
            }else if (newPassword == oldPassword){
                $(".form-group>input").eq(1).parent().children("div.alert").eq(1).css({"display":"block"});
                flag = false;
            } else {
                $(".form-group>input").eq(1).parent().children("div.alert").css({"display":"none"});
                flag = true;
            }

            /*确认新密码*/
            var newPassword2 = $(".form-group>input").eq(2).val();
            if(newPassword2.trim().match(Reg2) == null || newPassword2.trim().match(/[ ]+/) != null ){
                $(".form-group>input").eq(2).parent().children("div.alert").eq(0).css({"display":"block"});
                flag = false;
            }else{
                $(".form-group>input").eq(2).parent().children("div.alert").eq(0).css({"display":"none"});
                flag = true;
            }

            if(newPassword != newPassword2){
                $(".form-group>input").eq(2).parent().children("div.alert").eq(0).css({"display":"block"});
                flag = false;
            }

            if(flag == true){
                $(".commit").removeAttr("disabled");
            }else {
                $(".commit").attr("disabled","");
            }
        }
    })
</script>
</html>